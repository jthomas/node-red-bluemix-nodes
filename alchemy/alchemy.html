<!--
  Copyright 2013,2015 IBM Corp.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

  http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->

<script type="text/x-red" data-template-name="alchemy-api">
    <div class="form-row">
        <label for="node-input-name"><i class="fa fa-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-features" style="width: 100%"><i class="fa fa-book"></i> Extract the following features: </label>
          <div style="float: left;">
            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;" type="checkbox" id="node-input-page-image"><label style="width: auto;" for="node-input-page-image">Page Images</label>
            </div>
            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;" type="checkbox" id="node-input-image-keyword"><label style="width: auto;" for="node-input-image-keyword">Image Keywords</label>
            </div>
            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;" type="checkbox" id="node-input-feed"><label style="width: auto;" for="node-input-feed">Feed</label>
            </div>
            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;" type="checkbox" id="node-input-entity"><label style="width: auto;" for="node-input-entity">Entities</label>
            </div>
            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;" type="checkbox" id="node-input-title"><label style="width: auto;" for="node-input-title">Title</label>
            </div>
            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;" type="checkbox" id="node-input-author"><label style="width: auto;" for="node-input-author">Authors</label>
            </div>
          </div>
          <div style="margin-left: -200px; float: right;">
            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;" type="checkbox" id="node-input-keyword"><label style="width: auto;" for="node-input-keyword">Keywords</label>
            </div>
            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;" type="checkbox" id="node-input-taxonomy"><label style="width: auto;" for="node-input-taxonomy">Taxonomy</label>
            </div>
            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;" type="checkbox" id="node-input-concept"><label style="width: auto;" for="node-input-concept">Concepts</label>
            </div>
            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;" type="checkbox" id="node-input-relation"><label style="width: auto;" for="node-input-relation">Relations</label>
            </div>
            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;" type="checkbox" id="node-input-pub-date"><label style="width: auto;" for="node-input-pub-date">Publication Date</label>
            </div>
            <div>
              <input style="width: 30px; margin-left: 20px; margin-top: 0;" type="checkbox" id="node-input-doc-sentiment"><label style="width: auto;" for="node-input-doc-sentiment">Document Sentiment</label>
            </div>
          </div>
        </div>
    <div class="form-tips" id="node-missing-service-warning" style="display: none"><i class="fa fa-warning"></i><b> Warning:</b> There is no Alchemy API service connected
    </div>
</script>

<script type="text/x-red" data-help-name="alchemy-api">
    <p>Using the Question and Answer service you can connect to Watson, post questions, and receive responses.</p>
    <p>There are two default corpora to choose from.</p>
    <ul>
        <li><b>Watson for Healthcare</b>, which derives cognitive conclusions from documents about health concerns and diseases.</li>
        <li><b>Watson for Travel</b>, which responds to questions based on cognitive analysis of a corpus that was initially created from documents about travel and associated locations.</li>
    </ul>
    <p>The question you want to ask should be passed in on <b>msg.payload</b>.</p>
    <p>If you choose to only return the top answer, the answer will returned in <b>msg.payload</b> and the confidence of that answer in <b>msg.confidence</b>.</p>
    <p>If you choose to return all answers, the results array will be returned in <b>msg.payload</b>. Each answer in the array will have a <b>payload</b> and <b>confidence</b> property.</p>
    <p>For more information about the Question and Answer service, read the <a href="https://www.ibm.com/smarterplanet/us/en/ibmwatson/developercloud/question-answer.html">documentation</a>.</p>
</script>

<script type="text/javascript">
    (function() {

        RED.nodes.registerType('alchemy-api', {
            category: 'Alchemy API',
            defaults: {
              name: {value: ""},
              "page-image": {value: ""},
              "image-keyword": {value: ""},
              feed: {value: ""},
              entity: {value: ""},
              keyword: {value: ""},
              title: {value: ""},
              author: {value: ""},
              taxonomy: {value: ""},
              concept: {value: ""},
              relation: {value: ""},
              "pub-date": {value: ""},
              "doc-sentiment": {value: ""}
            },
            color: "rgb(32, 178, 239)",
            inputs: 1,
            outputs: 1,
            icon: "question.png",
            paletteLabel: "Alchemy API",
            label: function() {
                return this.name || "Alchemy API";
            },
            labelStyle: function() {
                return this.name ? "node_label_italic" : "";
            },
            oneditprepare: function() {
              $.getJSON('alchemy-api/vcap/', function(service) {
                if (!service) {
                  $("#node-missing-service-warning").show();
                }
              });
            }
        });
    })();
</script>
